public class AutoQuotingResourceAccessor extends ClassLoaderResourceAccessor {
    @Override
    public InputStream openStream(String relativeTo, String streamPath) throws IOException {
        InputStream original = super.openStream(relativeTo, streamPath);
        
        if (streamPath != null && streamPath.contains("changelog") && streamPath.endsWith(".xml")) {
            String content = new String(original.readAllBytes(), StandardCharsets.UTF_8);
            
            if (content.contains("<databaseChangeLog") && !content.contains("objectQuotingStrategy")) {
                content = content.replace(
                    "<databaseChangeLog",
                    "<databaseChangeLog objectQuotingStrategy=\"QUOTE_ALL_OBJECTS\""
                );
            }
            return new ByteArrayInputStream(content.getBytes(StandardCharsets.UTF_8));
        }
        return original;
    }
}
